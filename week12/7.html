<!--
 * @Author: vivien
 * @Date: 2020-10-16 22:32:17
 * @Last Modified by: vivien
 * @LastEditTime: 2020-10-17 12:36:56
-->
<div id="container">
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字
    文字 文字 文字 文字 文字

</div>
<div id="dragable" style="display:inline-block;width:100px;height:100px;background:pink;"></div>
<script>
   let dragable = document.getElementById('dragable');

   let baseX = 0, baseY = 0;

   dragable.addEventListener('mousedown', function(event){
       let startX = event.clientX, startY = event.clientY;

       let up = event => {
           baseX = baseX + event.clientX - startX;
           baseY = baseY + event.clientY - startY;

           document.removeEventListener('mousemove', move);
           document.removeEventListener('mouseup', up);
       }

       let move = event => {
        //    dragable.style.transform = `translate(${baseX + event.clientX - startX}px, ${baseY + event.clientY - startY}px)`;
           let range = getNearest(event.clientX, event.clientY);
           range.insertNode(dragable);
       }

       document.addEventListener('mousemove', move);
       document.addEventListener('mouseup', up);
   })

   let container = document.getElementById('container');
   let ranges = [];

   for(let i = 0; i < container.childNodes[0].textContent.length; i++) {
       let range = document.createRange();
       range.setStart(container.childNodes[0], i);
       range.setEnd(container.childNodes[0], i);
       console.log(range.getBoundingClientRect());
       ranges.push(range)
   }

   function getNearest(x, y) {
      let min = Infinity;
      let nearest = null;

      for(let range of ranges) {
          let react = range.getBoundingClientRect();
          let distance = (react.x - x) ** 2 + (react.y - y) **2;

          if(distance < min) {
             nearest = range;
             min = distance;
          }
      }
      return nearest;
   }
document.addEventListener('selectstart', event => event.preventDefault())
</script>